<html lang="en">
    <head>
        <base href="/">
        <meta charset="utf-8">
        <title>Listbuilder</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="robots" content=""> 
        <link rel="shortcut icon" href="">
        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <link rel="stylesheet" type="text/css" href="listbuilder/style/listbuilder.css"/>
    </head>
    <style>
        /**{
            font-family:Sans-serif;
        }
        body{
            margin:0 auto;
            min-height:400px;
        }
        #topBar{
            background-color:#65b1f0;
            position:fixed;
            margin-top:0;
            width:100%;
            color:#ffffff;
            height:75px;
        }
            #topBar p{
                padding-left:30px;
                text-align:left;
                font-weight:bold;
                vertical-align:center;
            }
        .button{
            padding:5px;
            background-color:#65b1f0;
            font-weight:"Bold";
            color:#ffffff;
            border:none;
        }
        #listEntry{
            margin:0 auto;
            text-align:center;
        }
            #listEntry #listEntryArea{
                width:100%;
                max-width:700px;
                font-size:16;
            }
        #formList{
            margin:0 auto;
            width:40%;
            height:40px;
            font-size:15;
            margin-top:5px;
        }
        #additionalButtons{
            margin:0 auto;
            align:center;
            padding-bottom:30px;
        }
            #additionalButtons #listModifiersContainer{
                margin:0 auto;
                width:60%;
            }
        #listSectionContainer{
            padding-top:30px;
            width:80%;
            margin:0 auto;
        }
        .listItem{
            margin:0 auto;
        }
        .listRow{
            margin:0 auto;
            padding-bottom:30px;
        }
            .listRow table{
                width:100%;
            }  
                .listRow table .removeTD .removeButton{
                    float:left;
                    width:100%;
                    height:40px;
                    background-image:url("listbuilder/img/trash.png");
                    background-size: 25px 30px;
                    background-repeat:no-repeat;
                    background-position:center;
                }
                .listRow table .nameTD .nameInput{
                    height:40px;
                    font-size:12;
                    width:100%;
                }
                .listRow table .completedTD{
                    width:10%;
                }
                    .listRow table .completedTD .completedInputContainer{
                        float:left;
                        width:25px;
                        height:25px;
                        border:1px solid #000000;
                    }
            
        @media screen and (min-width:768px){
            .button:hover{
                background-color:#c2e0f9;
                color:#ffffff;
            }
            #topBar p{
                font-size:25;     
                font-height:50px; 
            }
            #topBar #mobile_reset_btn{
                display:none;
            }
            #mobile_add_btn{
                display:none;
            }
            #listEntry{
                width:80%;
            }
            #collapsable{
                padding-top:85px;
            }
            #additionalButtons{ 
                padding-top:75px;
            }
                #additionalButtons #listModifiersContainer{
                    text-align:justify;
                }
                    #additionalButtons #listModifiersContainer:after{
                        display:inline-block;
                        width:100%;
                        content:'';
                    }
                #additionalButtons button{
                    display:inline-block;
                    height:40px;
                    font-size:15;
                    width:30%;
                }
                #additionalButtons #listModifiersContainer #showHide{
                    white-space:nowrap;
                    overflow:hidden;
                    min-width:127px;
                } 
            .listRow{
                width:70%;
                min-width:470px;
            }
                    .listRow table .removeTD{
                        width:8%;
                    }      
                    .listRow table .nameTD{
                        width:70%;
                    }
                        .listRow table .nameTD .nameInputContainer{
                            width:80%;
                            margin:0 auto;
                        }
                        .listRow table .completedTD .completedInputContainer:hover{
                            background-color:#f4b178;
                        }
                .completed{
                    background-color:#e27313;
                }
            }
        @media screen and (max-width:768px){
            #topBar{
                height:50px;
                line-height:20px;
            }
            #topBar p{
                float:left;
                font-size:20;
                font-height:20px;
            }
            #topBar #mobile_reset_btn{
                float:right;
                background-color:#ffffff;
                color:#65b1f0;
                display:unset;
                border-left:none;
                border-right:none;
                width:25%;
                height:100%;
                font-size:15;
                border-bottom:10px solid #65b1f0;
                border-top:10px solid #65b1f0;
            }
            #mobile_add_btn{
                display:unset;
                position:fixed;
                bottom:30;
                right:10;
                background-color:orange;
                border-radius:20px;
                width:50px;
                height:50px;  
            }   
                #mobile_add_btn p{
                    text-align:center;
                    font-size:25px;
                    color:#ffffff;
                    line-height:0px;      
                }
            #listEntry{
                padding-top:55px;
                width:90%;
            }
                #listEntry #listEntryArea{
                    width:100%;
                }
            #formList{
                margin:0 auto;
                width:80%;
                height:40px;
                font-size:15;
                margin-top:10px;
            }
            #listSectionContainer{
                padding-top:10px;
                width:100%;
                margin:0 auto;
            }
            #additionalButtons{
                width:90%;
            }
                #additionalButtons #listModifiersContainer #add_btn{
                    display:none;
                }
                #additionalButtons #listModifiersContainer #clear_btn{
                    display:none;
                }
                #additionalbuttons #listModifiersContainer #showHide{
                    margin-top:60px;
                    width:100%;
                    height:40px;
                    font-size:15;
                }
            .listRow{
                width:90%;
            }
                .listRow table .removeTD{
                    width:12%;
                }
                .listRow table .nameTD{
                    width:75%;
                }
                    .listRow table .nameTD .nameInputContainer{
                        width:90%;
                        margin:0 auto;
                    }     
                .listRow table .completedTD{
                    width:10%;
                }
                    .listRow table .completedTD .completedInputContainer{
                        float:left;
                        width:25px;
                        height:25px;
                        border:1px solid #000000;
                    }
            .completed{
                background-color:#e27313;
            }
        }*/
    </style>
    
    <body ng-app="ListBuilderApp" ng-controller="mainCtrl">
        <div id="topBar">
            <p>ListBuilder</p>
            <button id="mobile_reset_btn" ng-click="Reset()">Reset</button>
        </div>
        <div>
            <div id="collapsable">
                <div id="listEntry">
                    <p>Enter your list below in paragraph form. Split it up by commas and your list will be created automatically.</p>
                    <textarea id="listEntryArea" placeholder="Start your list" autofocus="TRUE" rows="10" cols="80" ng-model="initialList"></textarea>
                    <button id="formList" class="button" ng-click="FormList()">Form List</button>
                </div>
            </div>
            <div id="mobile_add_btn" ng-click="AddListItem()">
                <p>+</p>
            </div>
            <div id="listSectionContainer">
                <div id="additionalButtons">
                    <div id="listModifiersContainer">
                        <button id="add_btn" class="button listModifier" ng-click="AddListItem()">Add Item</button>
                        <button id="showHide" class="button" onclick="ShowHide()">Show Bulk Editor</button>
                        <button id="clear_btn" class="button listModifier" ng-click="Reset()">Reset List</button>
                    </div>
                </div>
                <div id="listContainer">
                    <!--<ul id="finalList">
                        
                    </ul>-->
                    <div class="listItem" ng-repeat="item in finalList">
                        <!--{{ item }}-->
                        <!--<tableList info="item"></tableList>-->
                        <div class="listRow">
                            <table>
                                    <tr>
                                        <td class="removeTD">
                                            <button class="removeButton button" type="button" ng-click="RemoveItem(item)"></button>
                                            <input type="hidden" id="rank" value="{{item.listIndex}}" type="number">
                                        </td>
                                        <td class="nameTD">
                                            <div class="nameInputContainer">
                                                <input class="listInput nameInput form-control"  name="name" type="text" placeholder="name" ng-model="item.name">
                                            </div>
                                        </td>
                                        <td class="completedTD">
                                            <div class="completedInputContainer" ng-click="CheckOffItem(item)" ng-class="{completed: item.completed}">
                                                <!--<input class="cbInput form-control" type="checkbox" ng-click="CheckOffItem(item)" ng-checked="{{item.completed}}" value="{{item.completed}}" ng-model="item.completed">-->
                                            </div>
                                        </td>
                                    </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
   
            var buttons = document.getElementById("additionalButtons");
            var collapsingSection = document.getElementById("collapsable");
            $('#collapsable').hide();
            
            function ShowHide(){
                 $('#collapsable').slideToggle();
                var btn_showHide = document.getElementById("showHide");

                if($('#showHide').text() == "Show Bulk Editor"){
                    $('#showHide').text("Hide");
                    $('#listEntryArea').focus();
                }else{
                    $('#showHide').text("Show Bulk Editor");
                }   
            }
            

            var app = angular.module('ListBuilderApp', []);
            app.controller('mainCtrl', function($scope){
               $scope.initialList = "";
               $scope.finalList = [];
               var basicListItem = {
                   listIndex: 0,
                   name: "New",
                   completed: false
               };
            
               $scope.Init = function(){
                   var firstListItem = angular.copy(basicListItem);
                   $scope.finalList.push(firstListItem);
               }
               $scope.FormList = function(){
                   
                   ShowHide();
                   var initList = $scope.initialList;
                   var DOMlist = document.getElementById("finalList");
                   //clear DOMlist and finalList to refresh upon resubmit
                   while(DOMlist.firstChild){
                       DOMlist.removeChild(DOMlist.firstChild);
                   }
                   $scope.finalList = [];
                  //declare array
                  var array = initList.split(",");
                  if(array.length > 0){
                        //insert into final array
                        for(var i = 0, len = array.length;i < len; i++){                    
                            $scope.createListElement(array[i], i);
                        }
                  }
                  buttons.style.visibility = 'visible';
               } 
               $scope.RemoveItem = function(item){
                   var itemIndex = $scope.finalList.indexOf(item);
                   $scope.finalList.splice(itemIndex, 1);
               }
               $scope.AddListItem = function (){
                   var newListItem = angular.copy(basicListItem);
                   //add to top of list
                   $scope.finalList.splice(0,0, newListItem);
               }
               $scope.Reset = function(){
                   $scope.initialList = [];
                   $scope.finalList = [];
                   $scope.Init();
               }
               $scope.CheckOffItem = function(item){
                   var currentIndex = $scope.finalList.indexOf(item);
                   //store checked off item, then remove it and place it at the end
                   var checkedItem = $scope.finalList[currentIndex];
                   //flip completed property
                   checkedItem.completed = !checkedItem.completed;
                   //if item just unchecked, move to top of checked off items
                   if(checkedItem.completed == false){
                       $scope.UncheckItem(checkedItem);
                   }else{
                       $scope.finalList.splice(currentIndex,1);
                       $scope.finalList.push(checkedItem);
                   }
               }
               $scope.UncheckItem = function(item){
                   //default the top checked index to the last element in case there is only one checked item
                   var topCheckedIndex = $scope.finalList.length - 1;
                   var currentItem;
        
                   //find top completed item, and place newly unchecked item above that
                   for(var i = 0; i < $scope.finalList.length - 1; i++){
                       currentItem = $scope.finalList[i];
                       if(currentItem.completed){
                            topCheckedIndex = $scope.finalList.indexOf(currentItem);
                            break;
                       }
                   }
                  
                   //remove item being unchecked
                   $scope.finalList.splice($scope.finalList.indexOf(item), 1);
                   //place in correct spot and change checked property
                   $scope.finalList.splice(topCheckedIndex,0,item);
                   
               }
               //scan/clean the input, insert into final array and create the table on screen
               $scope.createListElement = function(listItem, index){
                   
                   //check item before inserting into final array?
                   if(listItem == null || listItem == ""){
                       return;
                   }
                   //trim and insert into final array
                   listItem = listItem.trim();
                   var newItem = angular.copy(basicListItem);
                   newItem.name = listItem;
                   newItem.listIndex = index;
                   $scope.finalList.push(newItem);
                   
               }
               $scope.Init();
            });
            app.directive("tableList", function(){
               return {
                   scope: {
                       info: '='
                   },
                   templateUrl:'js/tableList.html',
                   controller: function( $scope){
                       $scope.add = function() {

                       }
                   }
               }; 
            });
        </script>
       
        <!--<script src="js/app.js"></script>
        <script src="js/Controller.js"></script>-->
    </body>
</html>

